# API –û–ë–ù–û–í–õ–ï–ù–ò–Ø –¥–ª—è –ø—Ä–æ–¥–∞–∫—à–µ–Ω–∞

## –ù–æ–≤—ã–µ endpoints:
- `POST /api/subscriptions/cancel` - –û—Ç–º–µ–Ω–∞ –∞–∫—Ç–∏–≤–Ω–æ–π –ø–æ–¥–ø–∏—Å–∫–∏

## –ò–∑–º–µ–Ω–µ–Ω–∏—è –≤ —Å—Ç—Ä—É–∫—Ç—É—Ä–µ –æ—Ç–≤–µ—Ç–æ–≤:

### GET /api/subscriptions/current
**–ë—ã–ª–æ:**
```json
{
  "has_subscription": true,
  "subscription": { ... },
  "user_type": "VIP"
}
```

**–°—Ç–∞–ª–æ:**
```json
{
  "has_subscription": true,
  "plan": "vip",
  "expires_at": "2024-01-28T00:00:00.000Z",
  "auto_renew": true,
  "days_remaining": 15,
  "subscription": { ... }
}
```

### GET /api/subscriptions/history
**–î–æ–±–∞–≤–ª–µ–Ω–æ –ø–æ–ª–µ:**
```json
{
  "subscriptions": [ ... ],
  "payments": [ ... ],  // NEW
  "pagination": { ... }
}
```

## Breaking changes:
- –û—Ç–º–µ–Ω–∞ –ø–æ–¥–ø–∏—Å–∫–∏ –±–æ–ª—å—à–µ –Ω–µ —Ç—Ä–µ–±—É–µ—Ç subscription ID
- –í—Å–µ —Ü–µ–Ω—ã –∏ –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç–∏ –ø–æ–ª—É—á–∞—é—Ç—Å—è –∞—Å–∏–Ω—Ö—Ä–æ–Ω–Ω–æ –∏–∑ –±–∞–∑—ã –¥–∞–Ω–Ω—ã—Ö
- –°—Ç—Ä—É–∫—Ç—É—Ä–∞ –æ—Ç–≤–µ—Ç–æ–≤ –∏–∑–º–µ–Ω–µ–Ω–∞ –¥–ª—è —Å–æ–≤–º–µ—Å—Ç–∏–º–æ—Å—Ç–∏ —Å —Ñ—Ä–æ–Ω—Ç–µ–Ω–¥–æ–º

## –ù–æ–≤—ã–µ –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç–∏:

### –û—Ç–º–µ–Ω–∞ –ø–æ–¥–ø–∏—Å–∫–∏ –±–µ–∑ ID
```javascript
// –°—Ç–∞—Ä—ã–π —Å–ø–æ—Å–æ–± (–±–æ–ª—å—à–µ –Ω–µ —Ä–∞–±–æ—Ç–∞–µ—Ç)
subscriptionsAPI.cancel(subscriptionId, reason);

// –ù–æ–≤—ã–π —Å–ø–æ—Å–æ–±
subscriptionsAPI.cancel(reason);
```



### –ü–æ–ª—É—á–µ–Ω–∏–µ –±–∞–ª–∞–Ω—Å–∞ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
```javascript
// –ù–æ–≤—ã–π –º–µ—Ç–æ–¥
subscriptionsAPI.getBalance();
```

## –í–∞–ª–∏–¥–∞—Ü–∏—è –≤—Ö–æ–¥–Ω—ã—Ö –¥–∞–Ω–Ω—ã—Ö:
–í—Å–µ API endpoints —Ç–µ–ø–µ—Ä—å –∏—Å–ø–æ–ª—å–∑—É—é—Ç Joi –¥–ª—è –≤–∞–ª–∏–¥–∞—Ü–∏–∏:
- `subscription_type`: —Ç–æ–ª—å–∫–æ 'VIP' –∏–ª–∏ 'PREMIUM'
- `duration_months`: —Ç–æ–ª—å–∫–æ 1, 3 –∏–ª–∏ 12
- `payment_method`: —Ç–æ–ª—å–∫–æ —Ä–∞–∑—Ä–µ—à–µ–Ω–Ω—ã–µ –º–µ—Ç–æ–¥—ã
- `auto_renewal`: —Ç–æ–ª—å–∫–æ boolean

## Rate Limiting:
–ö—Ä–∏—Ç–∏—á–µ—Å–∫–∏–µ –æ–ø–µ—Ä–∞—Ü–∏–∏ –æ–≥—Ä–∞–Ω–∏—á–µ–Ω—ã:
- –ú–∞–∫—Å–∏–º—É–º 5 –æ–ø–µ—Ä–∞—Ü–∏–π —Å –ø–æ–¥–ø–∏—Å–∫–∞–º–∏ –∑–∞ 15 –º–∏–Ω—É—Ç
- –ü—Ä–∏–º–µ–Ω—è–µ—Ç—Å—è –∫ —Å–æ–∑–¥–∞–Ω–∏—é –∏ —Å–º–µ–Ω–µ –ø–ª–∞–Ω–æ–≤

## –ú–µ—Ç—Ä–∏–∫–∏ –∏ –∞—É–¥–∏—Ç:
–í—Å–µ –æ–ø–µ—Ä–∞—Ü–∏–∏ –ª–æ–≥–∏—Ä—É—é—Ç—Å—è —Å —Ç–µ–≥–∞–º–∏:
- `üìä [METRICS]` - –¥–ª—è –±–∏–∑–Ω–µ—Å-–º–µ—Ç—Ä–∏–∫
- `üîç [AUDIT]` - –¥–ª—è –∞—É–¥–∏—Ç-–ª–æ–≥–æ–≤

## –û–±—Ä–∞—Ç–Ω–∞—è —Å–æ–≤–º–µ—Å—Ç–∏–º–æ—Å—Ç—å:
- –í—Å–µ —Å—É—â–µ—Å—Ç–≤—É—é—â–∏–µ –ø–æ–ª—è —Å–æ—Ö—Ä–∞–Ω–µ–Ω—ã
- –ù–æ–≤—ã–µ –ø–æ–ª—è –¥–æ–±–∞–≤–ª—è—é—Ç—Å—è –±–µ–∑ —É–¥–∞–ª–µ–Ω–∏—è —Å—Ç–∞—Ä—ã—Ö
- –§—Ä–æ–Ω—Ç–µ–Ω–¥ –º–æ–∂–µ—Ç –ø–æ—Å—Ç–µ–ø–µ–Ω–Ω–æ –ø–µ—Ä–µ—Ö–æ–¥–∏—Ç—å –Ω–∞ –Ω–æ–≤—É—é —Å—Ç—Ä—É–∫—Ç—É—Ä—É
